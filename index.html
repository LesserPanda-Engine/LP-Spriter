<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Spriter for LesserPanda</title>
</head>
<body>
  <script src="pixi.js"></script>
  <script src="spriter.js"></script>

  <canvas id="canvas"></canvas>

  <script>
    PIXI.loader
      .add('player.scon', 'GreyGuy/player.scon')
      .after(spriter.loaderMiddleWare)
      .once('complete', start)
      .load();

    function start() {
      var renderer = PIXI.autoDetectRenderer(600, 400, {
        view: document.querySelector('#canvas')
      });
      var stage = new PIXI.Container();

      // Create and init spriter objects
      // var NUM_X = 20;
      // var NUM_Y = 8;
      var NUM_X = 16;
      var NUM_Y = 8;

      var i, j;
      var obj, objects = [];
      for (i = 0; i < NUM_X; i++) {
        for (j = 0; j < NUM_Y; j++) {
          obj = new spriter.SpriterAnimation('player.scon', 'Player');
          obj.play('walk');
          obj.setTime(i * 40);
          obj.scale.set(0.2, -0.2);
          obj.position.set(i * 30 + 10, 50 + j * 50);
          stage.addChild(obj);

          objects.push(obj);
        }
      }

      var prevTime = 0;
      function render(time) {
        requestAnimationFrame(render);

        // Delta time
        var dt = time - (prevTime || time);
        prevTime = time;

        // Update animation
        for (i = 0; i < NUM_X * NUM_Y; i++) {
          objects[i].update(dt);
        }

        renderer.render(stage);
      }

      requestAnimationFrame(render);
    }
  </script>
</body>
</html>
